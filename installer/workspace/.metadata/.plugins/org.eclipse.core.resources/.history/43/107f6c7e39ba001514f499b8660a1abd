/*
 * MyThread.cpp
 *
 *  Created on: Jan 12, 2016
 *      Author: dedy
 */

#include <MyThread.h>

wxDEFINE_EVENT(wxEVT_COMMAND_THREAD_COMPLETED, wxThreadEvent);
wxDEFINE_EVENT(wxEVT_COMMAND_THREAD_UPDATE, wxThreadEvent);

MyThread::MyThread(UIMyFrame1 *handler) :
		wxThread(wxTHREAD_DETACHED) {
	m_pHandler = handler;
}

MyThread::~MyThread() {

	wxCriticalSectionLocker enter(m_pHandler->m_pThreadCS);
	// the thread is being destroyed, make sure not to leave dangling pointer arround
	m_pHandler->m_pThread = NULL;

}

wxThread::ExitCode MyThread::Entry() {

	PrtDebug()
	;

	while (!TestDestroy()) {
		// do a bit of job ...
		wxMilliSleep(2000);
		wxQueueEvent(m_pHandler,
				new wxThreadEvent(wxEVT_COMMAND_THREAD_UPDATE));
	}

	// signal the event handler that this thread is going to be destroyed
	wxQueueEvent(m_pHandler, new wxThreadEvent(wxEVT_COMMAND_THREAD_COMPLETED));

	return (wxThread::ExitCode) 0;

}
